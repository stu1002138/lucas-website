{"_path":"/tech-dev/2024/08/26/cdn-content-delivery-network","_dir":"26","_draft":false,"_partial":false,"_locale":"","title":"內容傳遞網路（CDN）的運作與應用場景探討 | Lucas's Blog","description":"2024-08-26 介紹的CDN架構、功能以及應用場景​，以及實作範例。","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"內容傳遞網路cdn的運作與應用場景探討"},"children":[{"type":"element","tag":"span","props":{"className":["text-xl","font-bold"]},"children":[{"type":"text","value":"內容傳遞網路（CDN）的運作與應用場景探討"}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"傳統網站架設"},"children":[{"type":"element","tag":"span","props":{"className":["text-lg","font-bold"]},"children":[{"type":"text","value":"傳統網站架設"}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"傳統網站架設"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"是把網站內容放到一台Server"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"然後使用者在瀏覽器上點選網址後"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"會連到DNS把網址轉換成該網站的IP位置"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"然後再由瀏覽器直接連線到那台Server取得網站內容資料\n"},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"傳統網站運作流程","src":"https://cdn.lucas-chen.website/2024/08/26/01.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"那這個方式會有以下缺點"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"離Server 越遠 速度會越慢 (特別是全球性網站)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Server 穩定性比較差 (流量大，同時連線同一台Server，讓Server當機的機會變大)"}]}]},{"type":"element","tag":"h2","props":{"id":"cdn介紹"},"children":[{"type":"element","tag":"span","props":{"className":["text-lg","font-bold"]},"children":[{"type":"text","value":"CDN介紹"}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"所以就衍生出了CDN"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"CDN 全名 內容傳遞網路 – Content Delivery Network"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"可以將網站內容 部署到不同位置的邊緣節點"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"不同地區的用戶可以就近存取伺服器並取得內容"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"會有以下優點"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"實現加快載入速度 (物理上的距離降低)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"降低主機負擔 (都存取最近的CDN server，原本的Server 負載降低)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"可靠性提升 (多台cdn server就可以降低當機導致網站無法使用的風險)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"提升用戶體驗 (連線速度提升，瀏覽網站速度變快，且不容易網站掛掉)"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"CDN 運作流程圖："}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"CDN 網站運作流程","src":"https://cdn.lucas-chen.website/2024/08/26/02.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"將網站內容放到 主要存放資料的Server"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"並設定完CDN後"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"使用者連線到這個網站"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"會先連到DNS"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"DNS 再轉派發到 CDN DNS"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"CDN DNS再根據使用者的位置不同"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"回傳最靠近使用者的 CDN 邊緣伺服器 IP"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"然後使用者在連線到最靠近使用者的 CDN 邊緣伺服器 取得網站資料"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"CDN 簡易組成如下"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"主要存放資料的Server (Origin Server)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"DNS"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"CDN DNS"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"CDN 邊緣伺服器 (存放在不同國家地區的CDN Server)"}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"CDN 組成","src":"https://cdn.lucas-chen.website/2024/08/26/03.png"},"children":[]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"實戰演練"},"children":[{"type":"element","tag":"span","props":{"className":["text-lg","font-bold"]},"children":[{"type":"text","value":"實戰演練"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"我先將測試網站放了一堆GIF 檔案比較大的圖片"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"並且放到距離台灣很遠的地方"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"然後看他第一次載入網站的速度"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"CDN 實戰演練1","src":"https://cdn.lucas-chen.website/2024/08/26/04.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"CDN 實戰演練2","src":"https://cdn.lucas-chen.website/2024/08/26/05.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"CDN 實戰演練3","src":"https://cdn.lucas-chen.website/2024/08/26/06.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"發現到載入圖片的速度將近3秒"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"然後開始串上CDN"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"我使用 Cloudflare 這個CDN服務商，他有免費方案讓我使用"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"CDN 實戰演練4","src":"https://cdn.lucas-chen.website/2024/08/26/07.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"CDN 實戰演練5","src":"https://cdn.lucas-chen.website/2024/08/26/08.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"CDN 實戰演練6","src":"https://cdn.lucas-chen.website/2024/08/26/09.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"CDN 實戰演練7","src":"https://cdn.lucas-chen.website/2024/08/26/10.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"選完後，會有兩個 主要的 CDN DNS 需要設定在你的域名代理商"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"我是在Gandi購買的網域"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"所以我要去Gandi 設定網域 名稱伺服器\n"},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"CDN 實戰演練8","src":"https://cdn.lucas-chen.website/2024/08/26/11.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"CDN 實戰演練9","src":"https://cdn.lucas-chen.website/2024/08/26/12.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"CDN 實戰演練10","src":"https://cdn.lucas-chen.website/2024/08/26/13.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"設定完後就是這樣"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"掛載CDN 服務器後"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"就可以看看有了CDN 速度會變多快"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"CDN 實戰演練11","src":"https://cdn.lucas-chen.website/2024/08/26/14.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"相較於沒掛載CDN 服務之前 每張圖需要快3秒"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"掛載後，讀取網站 每張圖片不到 200毫秒"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"速度上快很多"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"那我要怎麼確認網站有串上CDN呢"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"可以直接在網址後面加上 cdn-cgi/trace"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"可以看到colo=KHH 代表者是連到高雄的cdn edge server"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"台北 連高雄 速度上就真的可以加快很多呢！"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"CDN 實戰演練12","src":"https://cdn.lucas-chen.website/2024/08/26/15.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"不只網站可以用CDN 加快"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"還有影片串流 跟  軟體安裝檔案  或是 遊戲的圖片影片加速"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"都是使用CDN 來讓速度提升，使用者體驗變好的應用"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"如果有什麼不足的部分，歡迎補充喔"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"謝謝大家！"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"傳統網站架設","depth":2,"text":"傳統網站架設"},{"id":"cdn介紹","depth":2,"text":"CDN介紹"},{"id":"實戰演練","depth":2,"text":"實戰演練"}]}},"_type":"markdown","_id":"content:tech-dev:2024:08:26:cdn-content-delivery-network.md","_source":"content","_file":"tech-dev/2024/08/26/cdn-content-delivery-network.md","_stem":"tech-dev/2024/08/26/cdn-content-delivery-network","_extension":"md"}